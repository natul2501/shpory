<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
	<title>Diary</title>
	<link rel="icon" type="image/png" href="media/icon.png">
	<link rel="stylesheet" type="text/css" href="/diary/public/css/diarystyle.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<meta name="robots" content="noindex, nofollow"> <!-- —Ä–æ–±–∏—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—é –≤—ñ–¥ –ø–æ—à—É–∫–æ–≤–∏—Ö –±–æ—Ç—ñ–≤ -->
</head>
<body>
<!------------------------------ HEADER----------------------------------->
	<header id="header">
		<h2>TAGEBUCH</h2>
		<!--<div id="descr">–û–ø–∏—Å</div>-->
	</header>
	<div id="panelInstruments">
		<a class="panelInstrumentsButton" href="/diary/public/flysquirrel-diary/ua">üá∫üá¶</a>
		<a class="panelInstrumentsButton" href="/diary/public/flysquirrel-diary/de">üá©üá™</a>
		<% if(user) { %>
			<a class="panelInstrumentsButton" href="/diary/public/flysquirrel-diary/logout">Abmelden</a>
		<% } %>
		<% if(!user) { %>
			<a class="panelInstrumentsButton" href="/diary/public/flysquirrel-diary/login-de">Anmelden</a>
		<% } %>
	</div>
<!------------------------------ MENUS----------------------------------->
	<div id="menu">
		<ul>
				<li><a href="/" class="menuLink">Hauptseite</a></li>
				<li><a href="/diary/public/diaries.html" class="menuLink">Diaries</a></li>
				<li><a href="/diary/public/flysquirrel-diary/galerie" class="menuLink">Galerie</a></li>
				<% if(author) author.forEach(d => {
					if (d === 'flysquirrel-diary') { %>
					<li><a href="/diary/public/newArticle.html" class="menuLink">Neuer Artikel</a></li>
				<% }}) %>
		</ul>
	</div>
<!------------------------------ CONTENT----------------------------------->
	<div class="container">
		<div class="eventt">
			<div id="controls">
				<span><br><a href="/diary/public/flysquirrel-diary" class="iconStyle">Zur√ºck zum √úbersicht</a></span>
				<% if(author) author.forEach(d => {
					if (d === 'flysquirrel-diary') { %>
				<span>
					<a class="iconStyle" href="/diary/public/<%- authorLink %>/<%- articleId %>/remove" onclick="return confirmDeleteArticle(event)">
						<i class="fa-solid fa-trash" title="Artikel l√∂schen"></i>
					</a>
				</span>
				<span>
					<a class="iconStyle" href="/diary/public/newArticle-de.html?id=<%- articleId %>">
						<i class="fa-solid fa-pen-to-square" title="Artikel bearbeiten"></i>
					</a>
				</span>
				<% }}) %>
			</div>
			<p>&nbsp;</p>
			<div id="articleTime">
				<%- article.date %>
				<i class="<%- articleSymbol %>" title="<%- title %>"></i>
				<% if(viewerslist && (viewerslist.length > 0)) {%>
					<i style="color: gray; font-weight: normal;">( <%- viewerslist.join(', ') %> )</i>
				<%}%>
			</div>
			<div class="about"><%- article.content %></div>
			<div class="tags"><%- article.tags %></div>
			<p>&nbsp;</p>
			<div id="commentContainer">
			<h4 id="commentContainerDescription">Kommentare:</h4>
				<div id="addComment">
					<details>
						<summary><span id="commentFormDescr">Kommentar hinzuf√ºgen:<br></span></summary>
						<form name="commentForm" id="commentForm" method="post" action="/diary/public/flysquirrel-diary/comment">
							<input type="hidden" name="articleId" value="<%- articleId %>">
							<textarea name="commentFormText" id="commentFormText"></textarea><br>
							<input name="commentInput" id="commentInput" type="submit" value="Kommentar senden"/>
					</form>
					</details>
				</div>
				<p>&nbsp;</p>
				<div class="commetContainer">
					<% article.comments.slice(1).forEach(comment => { %>
						<div class="commetDiv">
							<div id="controls">
								<% if (user.username === comment.author) { %>
									<form method="POST" action="/diary/public/<%- authorLink %>/<%- articleId %>/removeComment" style="display:inline;"
										onsubmit="return confirmDeleteComment(event)">
										<input type="hidden" name="commentDate" value="<%- comment.date %>">
										<button type="submit" class="iconStyle" style="background:none; border:none; cursor:pointer;">
										  <i class="fa-solid fa-trash" title="Kommentar l√∂schen"></i>
										</button>
									  </form>
								<% } else  if(author){%>
								<% author.forEach(d => { %>
									<% if (d === 'flysquirrel-diary') { %>
										<form method="POST" action="/diary/public/<%- authorLink %>/<%- articleId %>/removeComment" style="display:inline;"
											onsubmit="return confirmDeleteComment(event)">
											<input type="hidden" name="commentDate" value="<%- comment.date %>">
											<button type="submit" class="iconStyle" style="background:none; border:none; cursor:pointer;">
											  <i class="fa-solid fa-trash" title="Kommentar l√∂schen"></i>
											</button>
										  </form>
									<% } %> <!-- –ó–∞–∫—Ä–∏–≤–∞—é—á–∏–π —Ç–µ–≥ –¥–ª—è if (d === 'flysquirrel-diary') -->
								<% })} %> <!-- –ó–∞–∫—Ä–∏–≤–∞—é—á–∏–π —Ç–µ–≥ –¥–ª—è forEach(d => { -->
							</div>
							
							<div class="commentAuthor"><%- comment.author %></div>
							<div class="commentDate"><%- comment.date %></div>
							<div class="commentText"><%- comment.commentText %></div>
						</div>
					<% }) %>
				</div>
			</div>
		</div>
	</div>
	<div id="menuTags">
		<center><b>Tags</b></center>
		<% tags.forEach(tag => { %>
			<a href="/diary/public/<%- authorLink %>/searchResults/<%- tag.name %>"
				class="tagLink"
				style="font-size:<%=14+(tag.count*0.5)%>px;">
					<%- tag.name %>
				</a>&nbsp; 
			<% }) %>
	</div>
	<script>
		function confirmDeleteArticle(event) {
			const isConfirmed = confirm("M√∂chten Sie den Artikel wirklich l√∂schen?");
			if (!isConfirmed) {
			event.preventDefault(); // –ë–ª–æ–∫—É—î–º–æ –ø–µ—Ä–µ—Ö—ñ–¥, —è–∫—â–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ "–ù—ñ"
			}
			return isConfirmed; // –î–æ–∑–≤–æ–ª—è—î –∞–±–æ –∑–∞–±–æ—Ä–æ–Ω—è—î –ø–µ—Ä–µ—Ö—ñ–¥
		}
		function confirmDeleteComment(event) {
		  const isConfirmed = confirm("M√∂chten Sie den Kommentar wirklich l√∂schen?");
		  if (!isConfirmed) {
			event.preventDefault(); // –°–∫–∞—Å–æ–≤—É—î–º–æ –≤—ñ–¥–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º–∏, —è–∫—â–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ "–ù—ñ"
		  }
		  return isConfirmed; // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ true –∞–±–æ false, —â–æ–± –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º–∏
		}
	</script>
</body>
</html>